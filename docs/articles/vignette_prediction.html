<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The predictive performance of objective activity measures derived from accelerometry data for 5-year all-cause mortality in NHANES • rnhanesdata</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The predictive performance of objective activity measures derived from accelerometry data for 5-year all-cause mortality in NHANES">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rnhanesdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/NHANES_accelerometry_introduction.html">Introduction to downloading and working with NHANES 2003-2004 and 2005-2006 accelerometry data</a>
    </li>
    <li>
      <a href="../articles/create-all-processed-data.html">Creating all processed data in the rnhanesdata package</a>
    </li>
    <li>
      <a href="../articles/estimate-bedtime-midpoints.html">estimate-bedtime-midpoints</a>
    </li>
    <li>
      <a href="../articles/vignette_prediction.html">The predictive performance of objective activity measures derived from accelerometry data for 5-year all-cause mortality in NHANES</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/andrew-leroux/rnhanesdata">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="vignette_prediction_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>The predictive performance of objective activity measures derived from accelerometry data for 5-year all-cause mortality in NHANES</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/andrew-leroux/rnhanesdata/blob/master/vignettes/vignette_prediction.Rmd"><code>vignettes/vignette_prediction.Rmd</code></a></small>
      <div class="hidden name"><code>vignette_prediction.Rmd</code></div>

    </div>

    
    
<p>We access the prediction performance of objective physical activity measures and their ranking relative to other established predictors of 5-year all-cause mortality in the US. In this analysis, we use participants between 50 and 85 years old from the 2003-2004 and 2005-2006 samples of the National Health and Nutritional Examination Survey (NHANES, n=2978, number of deaths in 5 years=297) who wore a hip-worn accelerometer in the free living environment for up to 7 days.</p>
<p><strong>Note: the html file displays only partial R code neccesary to illustrate the functions and arguments used to execute the analysis. Full code is available in the corresponding .Rmd file.</strong></p>
<div id="prerequisites" class="section level1">
<h1 class="hasAnchor">
<a href="#prerequisites" class="anchor"></a>Prerequisites</h1>
<p>The following packages will be used in this vignette to provide illustration of NHANES 5-year mortality prediction model. Note that we need to use R’s old default random number generator to reproduce published results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"knitr"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"kableExtra"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"devtools"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"ggplot2"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"gridExtra"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"corrplot"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"reshape2"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"magrittr"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"plyr"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"dplyr"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"survey"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"mgcv"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"refund"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"rnhanesdata"</span>)
<span class="kw"><a href="https://rdrr.io/r/base/Random.html">RNGkind</a></span>(<span class="dt">sample.kind=</span><span class="st">"Rounding"</span>)</code></pre></div>
<div id="nhanes-2003-2004-and-2005-2006-5-year-mortality-model-data-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#nhanes-2003-2004-and-2005-2006-5-year-mortality-model-data-selection" class="anchor"></a>NHANES 2003-2004 and 2005-2006 5-year mortality model data selection</h2>
<p>We start by downloading NHANES 2003-2004 and 2005-2006 cohorts’ information, processing data and combining survey weights for the two cohorts using R package <em>rnhanesdata</em> (Leroux, 2018). Items 1 - 11 illustrate processing steps we performed to obtain the subset of NHANES data that meets this analysis criteria, and derive activity summaries. These steps produce an R object called “data_analysis”, which is used in 5-year mortality prediction model. **For simplicity of presentation, we suppress code printout at each step, which can be changed by setting echo = TRUE in the R chunk option (e.g., {r, echo = TRUE}). Full code is available in the vignette_prediction.Rmd file*</p>
<ol style="list-style-type: decimal">
<li>Download and process NHANES lab measurements from the 2 cohorts: systolic blood pressure readings, total cholesterol, and HDL cholesterol. These data are saved in the temporary directory, which is then removed once the covariates information is processed. Blood pressure is recorded up to 4 times here for each participant. The data collection procedure and description of cholesterol and blood pressure variables is available at <a href="https://wwwn.cdc.gov/nchs/nhanes/search/datapage.aspx?Component=Examination&amp;CycleBeginYear=2003" class="uri">https://wwwn.cdc.gov/nchs/nhanes/search/datapage.aspx?Component=Examination&amp;CycleBeginYear=2003</a> for the wave 2003-2004 and at <a href="https://wwwn.cdc.gov/nchs/nhanes/search/datapage.aspx?Component=Examination&amp;CycleBeginYear=2005" class="uri">https://wwwn.cdc.gov/nchs/nhanes/search/datapage.aspx?Component=Examination&amp;CycleBeginYear=2005</a> for the wave 2005-2006.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create a (local) temporary directory </span>
<span class="co"># where lab measurement (cholesterol, blood presure) data will be downloaded from the CDC website </span>
<span class="co"># and then loaded into R. These files need to be downloaded separately as </span>
<span class="co"># the raw files associated with these lab measurements are not included in the rnhanesdata package.</span>
dir_tmp =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span>()

<span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/files2.html">dir.exists</a></span>(dir_tmp)){
  <span class="kw"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span>(dir_tmp, <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>)
}
dl_file =<span class="st"> </span><span class="cf">function</span>(url) {
  bn =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/basename.html">basename</a></span>(url) 
  destfile =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/file.path.html">file.path</a></span>(dir_tmp, bn)
  <span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(destfile)) {
    out =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span>(url, <span class="dt">destfile =</span> destfile, <span class="dt">mode=</span><span class="st">"wb"</span>)
  }
  <span class="kw"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span>(destfile))
}
## download the lab measurement data for the cohort 2003-2004
<span class="co"># Cholesterol - Total &amp; HDL: LBXTC and LBXHDD</span>
<span class="kw">dl_file</span>(<span class="st">"https://wwwn.cdc.gov/Nchs/Nhanes/2003-2004/L13_C.XPT"</span>)
<span class="co"># Blood Pressure: BPXSY1 , BPXSY2, BPXSY3 and BPXSY4</span>
<span class="kw">dl_file</span>(<span class="st">"https://wwwn.cdc.gov/Nchs/Nhanes/2003-2004/BPX_C.XPT"</span>)

## download the lab measurement data for the cohort 2005-2006
<span class="co"># Total Cholesterol: LBXTC</span>
<span class="kw">dl_file</span>(<span class="st">"https://wwwn.cdc.gov/Nchs/Nhanes/2005-2006/TCHOL_D.XPT"</span>)
<span class="co"># HDL Cholesterol: LBDHDD</span>
<span class="kw">dl_file</span>(<span class="st">"https://wwwn.cdc.gov/Nchs/Nhanes/2005-2006/HDL_D.XPT"</span>)
<span class="co"># Blood Pressure, up to 4 measurements per person: BPXSY1 , BPXSY2, BPXSY3 and BPXSY4</span>
<span class="kw">dl_file</span>(<span class="st">"https://wwwn.cdc.gov/Nchs/Nhanes/2005-2006/BPX_D.XPT"</span>)


varnames &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"LBXTC"</span>,<span class="st">"LBXHDD"</span>,<span class="st">"LBDHDD"</span>,           ## 1. cholesterol. Note LBXHDD and LBDHDD are the same variable, 
                                                   ##    but different names for 2003-2004 and 2005-2006 cohorts
              <span class="st">"BPXSY1"</span>,<span class="st">"BPXSY2"</span>,<span class="st">"BPXSY3"</span>, <span class="st">"BPXSY4"</span> ## 2. blood pressure measurements
              )


## load and merge the lab data
lab_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/process_covar.html">process_covar</a></span>(<span class="dt">varnames =</span> varnames,<span class="dt">localpath=</span>dir_tmp)

## change column name for cholesterol variable that changed names
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(lab_data<span class="op">$</span>Covariate_C)[<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(lab_data<span class="op">$</span>Covariate_C) <span class="op">==</span><span class="st"> "LBXHDD"</span>] &lt;-<span class="st"> "LBDHDD"</span>

## combine waves
CVMarkers &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(lab_data<span class="op">$</span>Covariate_C, lab_data<span class="op">$</span>Covariate_D)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"lab_data"</span>,<span class="st">"dir_tmp"</span>,<span class="st">"varnames"</span>))</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Load minute-level activity data and combine it with lab measurements, survey sampling data, and mortality data which are included in the <em>rnhanesdata</em> package.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## load the data
<span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"PAXINTEN_C"</span>);<span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"PAXINTEN_D"</span>)
<span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"Flags_C"</span>);<span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"Flags_D"</span>)
<span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"Mortality_2015_C"</span>);<span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"Mortality_2015_D"</span>)
<span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"Covariate_C"</span>);<span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"Covariate_D"</span>)

## re-code activity counts which are considered "non-wear" to be 0
## this doesn't impact many data points, most estimated non-wear times correspond to 0 counts
col_vars =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"MIN"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">1440</span>)
PAXINTEN_C[, col_vars] &lt;-<span class="st"> </span>PAXINTEN_C[, col_vars]<span class="op">*</span>Flags_C[, col_vars]
PAXINTEN_D[, col_vars] &lt;-<span class="st"> </span>PAXINTEN_D[, col_vars]<span class="op">*</span>Flags_D[, col_vars]

## Merge covariate, mortality, and accelerometry data
## note that both PAXINTEN_* and Covariate_* have a column
## called "SDDSRVYR" indicating which NHANES wave the data is associated with.
## To avoid duplicating this column in the merged data, we add this variable to the "by"
## argument in left_join()
AllAct_C &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(PAXINTEN_C, Mortality_2015_C, <span class="dt">by =</span> <span class="st">"SEQN"</span>) <span class="op">%&gt;%</span>
<span class="st">        </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(Covariate_C, <span class="dt">by=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SEQN"</span>, <span class="st">"SDDSRVYR"</span>))
AllAct_D &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(PAXINTEN_D, Mortality_2015_D, <span class="dt">by =</span> <span class="st">"SEQN"</span>) <span class="op">%&gt;%</span>
<span class="st">        </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(Covariate_D, <span class="dt">by=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SEQN"</span>, <span class="st">"SDDSRVYR"</span>))

AllFlags_C &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(Flags_C, Mortality_2015_C, <span class="dt">by =</span> <span class="st">"SEQN"</span>) <span class="op">%&gt;%</span>
<span class="st">        </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(Covariate_C, <span class="dt">by=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SEQN"</span>, <span class="st">"SDDSRVYR"</span>))
AllFlags_D &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(Flags_D, Mortality_2015_D, <span class="dt">by =</span> <span class="st">"SEQN"</span>) <span class="op">%&gt;%</span>
<span class="st">        </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(Covariate_D, <span class="dt">by=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"SEQN"</span>, <span class="st">"SDDSRVYR"</span>))

## clean up the workspace for memory purposes
<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"PAXINTEN_"</span>, <span class="st">"Covariate_"</span>,<span class="st">"Mortality_2015_"</span>,<span class="st">"Flags_"</span>),<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(LETTERS[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>],<span class="dt">each=</span><span class="dv">4</span>))))
<span class="kw"><a href="https://rdrr.io/r/base/gc.html">gc</a></span>()</code></pre></div>
<pre><code>##             used   (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)
## Ncells   2097600  112.1    4267247  227.9         NA   3290721  175.8
## Vcells 155701530 1188.0  400283835 3054.0      16384 342513909 2613.2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## combine data for the two waves
AllAct   &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(AllAct_C,AllAct_D)
<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AllAct_C"</span>,<span class="st">"AllAct_D"</span>))
AllFlags &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span>(AllFlags_C,AllFlags_D)
<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"AllFlags_C"</span>,<span class="st">"AllFlags_D"</span>))

<span class="co">#merge with cardiovascular markers </span>
AllAct &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(AllAct, CVMarkers, <span class="dt">by =</span> <span class="st">"SEQN"</span>)
AllFlags &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(AllFlags, CVMarkers, <span class="dt">by =</span> <span class="st">"SEQN"</span>)

## clean up the workspace again
<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list =</span> <span class="st">"CVMarkers"</span>);
<span class="kw"><a href="https://rdrr.io/r/base/gc.html">gc</a></span>()</code></pre></div>
<pre><code>##             used   (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)
## Ncells   2095065  111.9    4267247  227.9         NA   4267247  227.9
## Vcells 156798177 1196.3  400283835 3054.0      16384 400258277 3053.8</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Create new factor covariates from NHANES questionnaire, which will be used in the prediction model. In addition, calculate average systolic blood pressure using the 4 measurements per participant.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Code year 5 mortality, NAs for individuals with follow up less than 5 years and alive
AllAct<span class="op">$</span>yr5_mort &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>yr5_mort &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(
  <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(AllAct<span class="op">$</span>permth_exm<span class="op">/</span><span class="dv">12</span> <span class="op">&lt;=</span><span class="st"> </span><span class="dv">5</span> <span class="op">&amp;</span><span class="st"> </span>AllAct<span class="op">$</span>mortstat <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>,
         <span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(AllAct<span class="op">$</span>permth_exm<span class="op">/</span><span class="dv">12</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span> <span class="op">&amp;</span><span class="st"> </span>AllAct<span class="op">$</span>mortstat <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>, <span class="dv">0</span>))
                                                    )
## Create Age in years using the age at examination (i.e. when participants wore the device)
AllAct<span class="op">$</span>Age &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>Age &lt;-<span class="st"> </span>AllAct<span class="op">$</span>RIDAGEEX<span class="op">/</span><span class="dv">12</span>


## Re-level comorbidities to assign refused/don't know as not having the condition
## Note that in practice this does not affect many individuals, but it is an assumption we're making.
<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllAct<span class="op">$</span>CHD)    &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllFlags<span class="op">$</span>CHD)    &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"No"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"No"</span>,<span class="st">"Refused"</span>,<span class="st">"Don't know"</span>), <span class="st">"Yes"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Yes"</span>))
<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllAct<span class="op">$</span>CHF)    &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllFlags<span class="op">$</span>CHF)    &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"No"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"No"</span>,<span class="st">"Refused"</span>,<span class="st">"Don't know"</span>), <span class="st">"Yes"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Yes"</span>))
<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllAct<span class="op">$</span>Stroke) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllFlags<span class="op">$</span>Stroke) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"No"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"No"</span>,<span class="st">"Refused"</span>,<span class="st">"Don't know"</span>), <span class="st">"Yes"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Yes"</span>))
<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllAct<span class="op">$</span>Cancer) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllFlags<span class="op">$</span>Cancer) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"No"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"No"</span>,<span class="st">"Refused"</span>,<span class="st">"Don't know"</span>), <span class="st">"Yes"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Yes"</span>))
<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllAct<span class="op">$</span>Diabetes) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllFlags<span class="op">$</span>Diabetes) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"No"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"No"</span>,<span class="st">"Borderline"</span>, <span class="st">"Refused"</span>,<span class="st">"Don't know"</span>), <span class="st">"Yes"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Yes"</span>))


## Re-level education to have 3 levels and categorize don't know/refused to be missing
<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllAct<span class="op">$</span>EducationAdult) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllFlags<span class="op">$</span>EducationAdult) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"Less than high school"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Less than 9th grade"</span>, <span class="st">"9-11th grade"</span>),
                                                                         <span class="st">"High school"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"High school grad/GED or equivalent"</span>),
                                                                         <span class="st">"More than high school"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Some College or AA degree"</span>, <span class="st">"College graduate or above"</span>))

## Re-level alcohol consumption to include a level for "missing"
<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllAct<span class="op">$</span>DrinkStatus) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllFlags<span class="op">$</span>DrinkStatus) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(AllAct<span class="op">$</span>DrinkStatus), <span class="st">"Missing alcohol"</span>)
AllAct<span class="op">$</span>DrinkStatus[<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(AllAct<span class="op">$</span>DrinkStatus)] &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>DrinkStatus[<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(AllAct<span class="op">$</span>DrinkStatus)] &lt;-<span class="st"> "Missing alcohol"</span>


<span class="co"># systolic blood pressure calculation </span>
AllAct<span class="op">$</span>SYS &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>SYS &lt;-<span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>( <span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowMeans</a></span>(AllAct[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"BPXSY1"</span>,<span class="st">"BPXSY2"</span>,<span class="st">"BPXSY3"</span>, <span class="st">"BPXSY4"</span>)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))

## Re-order columns so that activity and wear/non-wear flags are the last 1440 columns of our two
## data matrices. This is a personal preference and is absolutely not necessary.
act_cols &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(AllAct) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"MIN"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">1440</span>))
oth_cols &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/which.html">which</a></span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(AllAct) <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"MIN"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">1440</span>))
AllAct   &lt;-<span class="st"> </span>AllAct[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(oth_cols,act_cols)]
AllFlags &lt;-<span class="st"> </span>AllFlags[,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(oth_cols,act_cols)]
<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"act_cols"</span>,<span class="st">"oth_cols"</span>))</code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Calculate daily activity summary measures: total activity count (TAC), total log activity count (TLAC), total accelerometer wear time (WT), total minutes of moderate/vigorous physical activity (MVPA), sedentary/sleep/non-wear to active transition probability (SATP<span class="math inline">\(_{sl/nw}\)</span>), and active to sedentary/sleep/non-wear transition probability (ASTP<span class="math inline">\(_{sl/nw}\)</span>). In addition, compute total log activity count summary measures (TLAC_1, TLAC_2, …, TLAC_12) in each 2-hr window, i.e. 12AM-2AM, 2AM-4AM, 4AM-6AM, etc. Note, there is one individual with 501 minutes recorded as NA. These missing data occur on the last day they wore the device for the last 501 minutes of the day. We impute these missing data with 0.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Assign just the activity and wear/non-wear flag data to matrices.
## This makes computing the features faster but is technically required.
act_mat  &lt;-<span class="st"> </span>AllAct[,<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"MIN"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">1440</span>)]
act_mat =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(act_mat)

## replace NAs with 0s
<span class="cf">for</span> (icol <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(act_mat))) {
  act_mat[, icol][<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(act_mat[, icol])]   &lt;-<span class="st"> </span><span class="dv">0</span>
}

AllAct<span class="op">$</span>TAC   &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>TAC   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(act_mat)
AllAct<span class="op">$</span>TLAC  &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>TLAC  &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>act_mat))
AllAct<span class="op">$</span>ST    &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>ST    &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(act_mat <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>)
AllAct<span class="op">$</span>MVPA  &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>MVPA  &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(act_mat <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2020</span>)

<span class="co"># compute total log activity count in each 2-hr window, </span>
<span class="co"># 2 hour (120 minutes) binning window </span>
tlen &lt;-<span class="st"> </span><span class="dv">120</span>
nt   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(<span class="dv">1440</span><span class="op">/</span>tlen)
<span class="co"># create a list of indices for binning into 2-hour windows</span>
inx_col_ls &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/split.html">split</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1440</span>, <span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">1</span><span class="op">:</span>nt,<span class="dt">each=</span>tlen))
Act_2hr    &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(inx_col_ls, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="dv">1</span><span class="op">+</span>act_mat[,x,<span class="dt">drop=</span><span class="ot">FALSE</span>])))
<span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(Act_2hr) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"TLAC_"</span>,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>))
<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"tlen"</span>,<span class="st">"nt"</span>,<span class="st">"inx_col_ls"</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">act_mat =<span class="st"> </span>act_mat <span class="op">&gt;=</span><span class="st"> </span><span class="dv">100</span>
## calculate fragmentation measures
get_sed_act =<span class="st"> </span><span class="cf">function</span>(x){
                        mat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/rle.html">rle</a></span>(x)
                        <span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(x)
                        sed &lt;-<span class="st"> </span>mat<span class="op">$</span>lengths[<span class="op">!</span>mat<span class="op">$</span>values]
                        act &lt;-<span class="st"> </span>mat<span class="op">$</span>lengths[mat<span class="op">$</span>values]

                        sed &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(sed) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>, <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(sed))
                        act &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(act) <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA</span>, <span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(act))
                        <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(sed, act)
}
bout_mat =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(act_mat))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(act_mat))) {
  bout_mat[, i] =<span class="st"> </span><span class="kw">get_sed_act</span>(act_mat[i, ])
}
<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(act_mat)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">AllAct<span class="op">$</span>SBout &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>SBout &lt;-<span class="st"> </span>bout_mat[<span class="dv">1</span>,]
AllAct<span class="op">$</span>ABout &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>ABout &lt;-<span class="st"> </span>bout_mat[<span class="dv">2</span>,]
AllAct<span class="op">$</span>SATP  &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>SATP  &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>AllAct<span class="op">$</span>SBout
AllAct<span class="op">$</span>ASTP  &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>ASTP  &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>AllAct<span class="op">$</span>ABout

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(bout_mat)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">AllAct<span class="op">$</span>WT    &lt;-<span class="st"> </span>AllFlags<span class="op">$</span>WT    &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span>(AllFlags[,<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"MIN"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">1440</span>)], <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">AllAct   &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(AllAct, Act_2hr)
AllFlags &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(AllFlags, Act_2hr)

<span class="kw"><a href="https://rdrr.io/r/base/rm.html">rm</a></span>(<span class="dt">list =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Act_2hr"</span>))</code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Exclude participants who were: 1) younger than 50 years old, or 85 and older at the time they wore the accelerometer (10, 859 participants); 2) missing BMI or education predictor variables (41 participants); 3) had fewer than 3 days of data with at least 10 hours of estimated wear time (517 participants); 4) missing mortality information (16 participants); 5) alive with follow up less than 5 years (17 participants); 6) missing systolic blood pressure, total cholesterol or HDL cholesterol measurements (293 participants). Table 1 below displays number of participants with missing data for all pairwise combinations of variables with missing data.</li>
</ol>
<pre><code>##            used  (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)
## Ncells  2100247 112.2    4267247  227.9         NA   4267247  227.9
## Vcells 54494542 415.8  461267778 3519.2      16384 564607656 4307.7</code></pre>
<table class="table table table-striped">
<caption>
Table 1: Missing data patterns
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
BMI
</th>
<th style="text-align:right;">
Education
</th>
<th style="text-align:right;">
Bad Accel Data
</th>
<th style="text-align:right;">
Mortality
</th>
<th style="text-align:right;">
Follow-up
</th>
<th style="text-align:right;">
Lab
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;">
Education
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Bad Accel Data
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
517
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
57
</td>
</tr>
<tr>
<td style="text-align:left;">
Mortality
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Follow-up
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Lab
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
57
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
293
</td>
</tr>
</tbody>
</table>
<ol start="6" style="list-style-type: decimal">
<li>Create our dataset for analysis, “data_analysis”, with one row per subject containing only those subjects who meet our inclusion criteria.</li>
</ol>
<p>Thus, after exclusion ctriteria were applied, the data set contained 2978 subjects. Among these participants, 86 had missing alcohol information; for these participants we introduced the category “Missing Alcohol” and retained them in the dataset.</p>
<p>Maximum follow-up time in this cohort in years</p>
<pre><code>## [1] 13.08333</code></pre>
<ol start="7" style="list-style-type: decimal">
<li><p>Calculate subject specific averages of the accelerometry features using only the “good” days of data.</p></li>
<li><p>Get log(count +1) activity data in a matrix format and conduct functional Principal Component analysis (fPCA) using the fpca.face() function with 50 knots in the <em>refund</em> package in R.</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Act &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Act_Analysis[,<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"MIN"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">1440</span>)])
Act[<span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(Act)] &lt;-<span class="st"> </span><span class="dv">0</span>
Act =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(Act)
fpca_fit &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/refund/man/fpca.face.html">fpca.face</a></span>(Act,<span class="dt">knots=</span><span class="dv">50</span>)</code></pre></div>
<ol start="9" style="list-style-type: decimal">
<li>Retain the first 6 PCs, which explain approximately 57% variability in the daily activity data (the space spanned by the rows of the matrix of non-smoothed log transformed activity counts) and obtain the score for each day on each PC and calculate the mean and standard deviation of these scores for each subject across days.</li>
</ol>
<p><img src="vignette_prediction_files/figure-html/fpca_plot-1.png" width="960" style="display: block; margin: auto;"></p>
<ol start="10" style="list-style-type: decimal">
<li>Identify the PC-specific mean and standard deviation that are significantly associated with 5-year mortality using backward selection logistic model fitted with svyglm() function in R. In this step, the demographic, behavioral and comorbidity variables were included in all models and the selection was conducted on the means and standard deviations of the scores on the 6 PCs (a total of 12 variables) using the compelx survey AIC criteria (Lumley and Scott 2015).</li>
</ol>
<p>Note, there are 86 participants with missing alcohol information, which was coded as an additional level of the DrinkStatus variable.</p>
<table class="table table table-striped">
<caption>
Table 2: Final backward selection model estimated coefficients
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Pr(&gt;|t|)
</th>
<th style="text-align:right;">
OR Estimate
</th>
<th style="text-align:right;">
OR Lower CL
</th>
<th style="text-align:right;">
OR Upper CL
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
-7.590
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.004
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
0.080
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
1.083
</td>
<td style="text-align:right;">
1.059
</td>
<td style="text-align:right;">
1.108
</td>
</tr>
<tr>
<td style="text-align:left;">
Former Smoker
</td>
<td style="text-align:right;">
0.487
</td>
<td style="text-align:right;">
0.021
</td>
<td style="text-align:right;">
1.627
</td>
<td style="text-align:right;">
1.073
</td>
<td style="text-align:right;">
2.485
</td>
</tr>
<tr>
<td style="text-align:left;">
Current Smoker
</td>
<td style="text-align:right;">
0.941
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
2.563
</td>
<td style="text-align:right;">
1.797
</td>
<td style="text-align:right;">
3.648
</td>
</tr>
<tr>
<td style="text-align:left;">
Non-Drinker
</td>
<td style="text-align:right;">
0.567
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
1.763
</td>
<td style="text-align:right;">
1.279
</td>
<td style="text-align:right;">
2.440
</td>
</tr>
<tr>
<td style="text-align:left;">
Heavy Drinker
</td>
<td style="text-align:right;">
1.053
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
2.866
</td>
<td style="text-align:right;">
1.423
</td>
<td style="text-align:right;">
5.576
</td>
</tr>
<tr>
<td style="text-align:left;">
Missing Alcohol
</td>
<td style="text-align:right;">
0.816
</td>
<td style="text-align:right;">
0.065
</td>
<td style="text-align:right;">
2.261
</td>
<td style="text-align:right;">
0.875
</td>
<td style="text-align:right;">
5.197
</td>
</tr>
<tr>
<td style="text-align:left;">
Underweight
</td>
<td style="text-align:right;">
0.597
</td>
<td style="text-align:right;">
0.384
</td>
<td style="text-align:right;">
1.817
</td>
<td style="text-align:right;">
0.400
</td>
<td style="text-align:right;">
6.520
</td>
</tr>
<tr>
<td style="text-align:left;">
Overweight
</td>
<td style="text-align:right;">
-0.554
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
0.575
</td>
<td style="text-align:right;">
0.386
</td>
<td style="text-align:right;">
0.854
</td>
</tr>
<tr>
<td style="text-align:left;">
Obese
</td>
<td style="text-align:right;">
-0.509
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.601
</td>
<td style="text-align:right;">
0.478
</td>
<td style="text-align:right;">
0.755
</td>
</tr>
<tr>
<td style="text-align:left;">
Diabetes: yes
</td>
<td style="text-align:right;">
0.286
</td>
<td style="text-align:right;">
0.161
</td>
<td style="text-align:right;">
1.331
</td>
<td style="text-align:right;">
0.879
</td>
<td style="text-align:right;">
1.989
</td>
</tr>
<tr>
<td style="text-align:left;">
CHF: yes
</td>
<td style="text-align:right;">
0.833
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
2.300
</td>
<td style="text-align:right;">
1.356
</td>
<td style="text-align:right;">
3.841
</td>
</tr>
<tr>
<td style="text-align:left;">
CHD: yes
</td>
<td style="text-align:right;">
0.113
</td>
<td style="text-align:right;">
0.671
</td>
<td style="text-align:right;">
1.120
</td>
<td style="text-align:right;">
0.649
</td>
<td style="text-align:right;">
1.879
</td>
</tr>
<tr>
<td style="text-align:left;">
Stroke: yes
</td>
<td style="text-align:right;">
0.287
</td>
<td style="text-align:right;">
0.299
</td>
<td style="text-align:right;">
1.332
</td>
<td style="text-align:right;">
0.756
</td>
<td style="text-align:right;">
2.279
</td>
</tr>
<tr>
<td style="text-align:left;">
Cancer: yes
</td>
<td style="text-align:right;">
0.273
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:right;">
1.314
</td>
<td style="text-align:right;">
0.939
</td>
<td style="text-align:right;">
1.823
</td>
</tr>
<tr>
<td style="text-align:left;">
Mobility Problem
</td>
<td style="text-align:right;">
0.620
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
1.859
</td>
<td style="text-align:right;">
1.270
</td>
<td style="text-align:right;">
2.719
</td>
</tr>
<tr>
<td style="text-align:left;">
Total Cholesterol
</td>
<td style="text-align:right;">
-0.003
</td>
<td style="text-align:right;">
0.243
</td>
<td style="text-align:right;">
0.997
</td>
<td style="text-align:right;">
0.992
</td>
<td style="text-align:right;">
1.002
</td>
</tr>
<tr>
<td style="text-align:left;">
HDL Cholesterol
</td>
<td style="text-align:right;">
-0.001
</td>
<td style="text-align:right;">
0.840
</td>
<td style="text-align:right;">
0.999
</td>
<td style="text-align:right;">
0.989
</td>
<td style="text-align:right;">
1.008
</td>
</tr>
<tr>
<td style="text-align:left;">
Systolic Blood Pressure
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.949
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
0.993
</td>
<td style="text-align:right;">
1.008
</td>
</tr>
<tr>
<td style="text-align:left;">
mi1
</td>
<td style="text-align:right;">
0.014
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
1.014
</td>
<td style="text-align:right;">
1.004
</td>
<td style="text-align:right;">
1.026
</td>
</tr>
<tr>
<td style="text-align:left;">
si6
</td>
<td style="text-align:right;">
-0.077
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.926
</td>
<td style="text-align:right;">
0.888
</td>
<td style="text-align:right;">
0.965
</td>
</tr>
</tbody>
</table>
<pre><code>##            used  (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)
## Ncells  2170190 116.0    4267247  227.9         NA   4267247  227.9
## Vcells 98629884 752.5  369014223 2815.4      16384 564607656 4307.7</code></pre>
<pre><code>##            used  (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)
## Ncells  2169664 115.9    4267247  227.9         NA   4267247  227.9
## Vcells 98629139 752.5  295211379 2252.3      16384 564607656 4307.7</code></pre>
<ol start="11" style="list-style-type: decimal">
<li>Replace the significant PC based measures with corresponding surrogate variables. This step is done to improve the interpretability and comparability (across studies) of results. For those unfamiliar with principal component analysis, reading the section “Intuition behind fPCA” below may be helpful in understanding this step further.</li>
</ol>
<p>Identifying potential surrogate measures is based on (subjective) interpretations involving the shapes of each principal component. Fundamentally, the idea is to use visual inspection of the principal components to identify the “dominant” features of each component. Then, we return to the original data, and calculate a statistic which we believe captures this dominant feature. For example, looking at the upper-left panel of the plot above in Step 10, we see that days which load negatively on the first the first principal component tend to be extremely active, while those who load positively tend to be very inactive. As a result, one reasonable “guess” at a surrogate measure which is highly associated with average first component is simply the total log transformed activity count (TLAC) for that day. If that is true, we would also expect that the average PC1 score within subjects is highly correlated with their average TLAC across days. In our data, average TLAC and average PC1 score are highly (negatively) correlated (<span class="math inline">\(\hat{\rho}\)</span> =-0.87), which is expected based on the sign of the first PC.</p>
<p>This procedure would then be repeated for each feature identified as potentially predictive. In our application, we are also interested in the standard deviation of PC6. Looking at the bottom-right panel of the plot above in Step 10, we see that there are 6 periods where the contrast is highest between days with positive and negative loadings (i.e. the difference between the <span class="math inline">\(+\)</span> and <span class="math inline">\(-\)</span> curves are largest). One reasonable guess for a statistic which is highly correlated with PC6 score is the difference in average activity during the specific time periods where positive/negative loadings are high/low, respectively. For example, days that load highly on PC6 should, on average, have higher activity during the mid morning (8AM-10AM), late afternoon (3PM-5PM) and late evening (10PM-12AM) and lower activity during the early morning (5AM-7AM), late morning/early afternoon (11AM-1PM), and early evening (6PM-8PM). Since we’re interested in the standard deviation of PC6 score, we calculate the standard deviation of average log-transformed activity counts during these periods as a surrogate measure for <span class="math inline">\(s_{i6}\)</span>. In our analysis, we used all 6 of these time periods and obtained an observed correlation of <span class="math inline">\(\hat{\rho}\)</span> = 0.87, though multiple choices can be explored to see which statistic has the highest correlation with <span class="math inline">\(s_{i6}\)</span>.</p>
</div>
<div id="intuition-behind-fpca" class="section level2">
<h2 class="hasAnchor">
<a href="#intuition-behind-fpca" class="anchor"></a>Intuition behind fPCA</h2>
<p>A major problem with PC analysis is that it is not always intuitive and requires a degree of familiarity with matrix algebra and complex trajectories (functional data analysis in statistics speak). While some of these problems are unavoidable given the complexity of the data, we will now provide the needed intuition for understanding both the PCs and the implication of our findings on the original data scale (daily minute-level activity profiles). We will start with explaining the first 2PCs, which are shown in the left-top panel of Figure 1.</p>
<p><img src="vignette_prediction_files/figure-html/plot_PC_profiles-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code>##            used  (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)
## Ncells  2361997 126.2    4267247  227.9         NA   4267247  227.9
## Vcells 99068442 755.9  295211379 2252.3      16384 564607656 4307.7</code></pre>
<p>The first PC (solid blue line) captures 22% of the overall variability in the observed daily profiles of activity. It has a distinct shape, with values starting negative between 12AM and 5AM then becoming strongly positive with a peak around 8AM and slowly decreasing but staying positive until 9:30PM, and then becoming negative after 9:30PM. This is exactly what we expected to see. For each subject, we have 3 - 7 days of valid activity data. Individuals with a positive score on this component (a.k.a., positively loaded on the first PC) on a given day will tend to have less activity during the night hours and more activity during the day hours than the average activity across all subject-days. The biggest difference between such a subject’s day and the average daily activity across all subjects is centered on the morning hours (8AM-9AM). In contrast, the second PC (dashed line) captures 14% of the overall variability in the observed daily activity profiles. It starts positive between 12AM and 2AM, then becomes negative between 2AM and 11AM, with a negative peak at 8AM, increases between 11 AM and 8PM, and decreases while staying positive after 8PM. Participants days with positive scores on this component will be more active in the evening than the average individuals dayly activity.</p>
<p>Now, let us investigate in detail the connection between PCs, scores and individual daily trajectories. The right panel in Figure 1 displays the one day of activity profiles for 3 subjects. Here, we plot the activity data smoothed for each subject and day using thin-plate penalized spline with 30 knots as implemented in the <strong>gam()</strong> function in the <strong>mgcv</strong> package in R. The individual days for subjects 21009 (red line) and 21913 (green line) have overall high activity, which is reflected by the high positive loadings on PC 1 (55.89 and 58.75, respectively). In contrast, the individual day’s activity for subject 21039 (blue line) has lower levels, which is reflected by the negative score on the first PC (-21.12). Subjects 21009 (red line) and 21039 (blue line) are mostly active between 7AM and 9PM and their corresponding scores of the second principal component are negative (-30.91 and -36.08, respectively). Subject 21913 (green line) is however, unusually highly active during night hours (8PM - 2AM) with a highly positive score on the second PC (66.05).</p>
<p>The last, but not least important interpretation is of means of scores versus standard deviation of scores. In Figure 1, we have displayed three days, one for each subject. However, each subject has multiple days and each day will get a score and a pattern. For example, on days when subject 21009 (red line) is less active the score on PC1 will be lower, even if the general pattern stays the same. Thus, for every subject and PC we obtain a vector of scores; for 21009 (red line) we obtain (38.39, 55.89, 35.55, 60.61, 40.91, 48.67, -21.25) on the first PC, where we showed only the trajectory corresponding to the 3rd day. What we calculate is the mean of these scores, 36.97, and the standard deviation, 27.27. The mean of the scores is relatively easy to interpret, as it represents whether the average of the 7 days is higher or lower on PC1. The standard deviation captures the day-to-day variability of the individual. In this case the mean and standard deviation for subject 21009 (red line) were 36.97 and 27.27, respectively. In contrast, for subject 21039 (blue line), the mean and standard deviation were -19.16 and 5.02, respectively, much smaller than for subject 21009 (red line). This means that both the overall mean and the daily variability around this larger mean are larger for subject 21009 than for subject 21039 (blue line). This is depicted in Figure 2, where we show smoothed activity data for all days for subjects 21009 (Figure 2a red lines) and 21039 (Figure 2b blue lines). Note that the red lines tend to be higher the blue lines and that the blue lines are less variable around their means. We conclude that, in general, average PC1 scores will tend to distinguish between lower and higher activity individuals whose are, on average, more active over the course of days with available activity data. In contrast, average PC2 scores will distinguish between individuals who, on average, have high activity in the morning and low in the evening/night and individuals who, on average, have lower activity intensity in the morning and higher during the evening/nighttime.</p>
<p>Of course, things are more complicated once we start interpreting every component. Instead, in Table 1 we will provide just the interpretation of those components and summaries that were found to be predictive of the outcome.</p>
<pre><code>##            used  (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)
## Ncells  2295656 122.7    4267247  227.9         NA   4267247  227.9
## Vcells 58183398 444.0  236169104 1801.9      16384 564607656 4307.7</code></pre>
<p><img src="vignette_prediction_files/figure-html/unnamed-chunk-6-1.png" width="960" style="display: block; margin: auto;"></p>
<pre><code>##            used  (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)
## Ncells  2334742 124.7    4267247  227.9         NA   4267247  227.9
## Vcells 58360178 445.3  188935284 1441.5      16384 564607656 4307.7</code></pre>
<table class="table table table-striped">
<caption>
Table 3: Interpretation of the results of FPCA
</caption>
<thead><tr>
<th style="text-align:left;">
Result
</th>
<th style="text-align:left;">
Interpretation
</th>
<th style="text-align:left;">
Surrogates
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
(-) association mi1
</td>
<td style="text-align:left;">
Individuals with higher levels of overall activity during the day, and those who have higher early afternoon activity relative to early AM are associated with later mortality
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Average TLAC
</li></ol>
</td>
</tr>
<tr>
<td style="text-align:left;">
(+) association si6
</td>
<td style="text-align:left;">
Individuals who are more variable in the start time of their daily activity are associated with earlier mortality.
</td>
<td style="text-align:left;">
<ol style="list-style-type: decimal"><li>Standard deviation of ratio of mid-day to morning/afternoon activity 2. Standard deviation of the difference in average activity during peaks/troughs highlighted by PC6
</li></ol>
</td>
</tr>
</tbody>
</table>
<pre><code>##            used  (Mb) gc trigger   (Mb) limit (Mb)  max used   (Mb)
## Ncells  2295524 122.6    4267247  227.9         NA   4267247  227.9
## Vcells 58170931 443.9  188935284 1441.5      16384 564607656 4307.7</code></pre>
</div>
<div id="mortality-prediction-model" class="section level2">
<h2 class="hasAnchor">
<a href="#mortality-prediction-model" class="anchor"></a>Mortality prediction model</h2>
<p>Once we’ve subset the data to obtain “data_analysis”, we calculate adjusted survey weights. These weights are calculated using the reweight_accel() function (see ?reweight_accel for help) which re-weights observed participants using age, gender, and ethnicity strata (among other things).</p>
</div>
<div id="results" class="section level2">
<h2 class="hasAnchor">
<a href="#results" class="anchor"></a>Results</h2>
<p>Participant characteristics by mortality status are detailed in Table 5. Predictors in Table 5 are ranked according to the AUC criteria in univariate logistic regression models, where each mortality prediction model was fitted with one covariate at a time. For example, TAC (Total activity count) is the most powerful single predictor of the 5-year mortality (AUC = 0.771), the next most predictive variable is Age (AUC = 0.758), and so on. We use cross validated survey weight adjusted AUC (auc_ij_adj column of object auc_mat_1_adj) calculated at the first step of the forward selection process.</p>
<table class="table table table-striped">
<caption>
Table 3: Demographic and clinical characteristics ranked by their predictive ability in the 5-year mortality model.
</caption>
<thead><tr>
<th style="text-align:left;">
Rank
</th>
<th style="text-align:left;">
Characteristics
</th>
<th style="text-align:left;">
Total
</th>
<th style="text-align:left;">
Survivors
</th>
<th style="text-align:left;">
Decedents
</th>
<th style="text-align:left;">
AUC
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
TAC
</td>
<td style="text-align:left;">
209786.1 (112911)
</td>
<td style="text-align:left;">
217926 (111868.8)
</td>
<td style="text-align:left;">
136307.9 (94316.3)
</td>
<td style="text-align:left;">
0.771
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
Age
</td>
<td style="text-align:left;">
65.9 (9.6)
</td>
<td style="text-align:left;">
65 (9.3)
</td>
<td style="text-align:left;">
73.4 (8.9)
</td>
<td style="text-align:left;">
0.758
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:left;">
MVPA
</td>
<td style="text-align:left;">
13.8 (17.1)
</td>
<td style="text-align:left;">
14.7 (17.3)
</td>
<td style="text-align:left;">
6.5 (12.1)
</td>
<td style="text-align:left;">
0.745
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
ASTP
</td>
<td style="text-align:left;">
0.3 (0.09)
</td>
<td style="text-align:left;">
0.29 (0.08)
</td>
<td style="text-align:left;">
0.37 (0.11)
</td>
<td style="text-align:left;">
0.733
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
Sedentary time
</td>
<td style="text-align:left;">
1110.6 (108.4)
</td>
<td style="text-align:left;">
1102.4 (105.1)
</td>
<td style="text-align:left;">
1184 (110.5)
</td>
<td style="text-align:left;">
0.728
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
TLAC
</td>
<td style="text-align:left;">
2758.5 (727.2)
</td>
<td style="text-align:left;">
2811.7 (705.6)
</td>
<td style="text-align:left;">
2278.7 (744.9)
</td>
<td style="text-align:left;">
0.721
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
TLAC 12PM-2PM
</td>
<td style="text-align:left;">
402.5 (117.3)
</td>
<td style="text-align:left;">
410.2 (113.9)
</td>
<td style="text-align:left;">
333.4 (125.3)
</td>
<td style="text-align:left;">
0.697
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
TLAC 4PM-6PM
</td>
<td style="text-align:left;">
373.8 (114.7)
</td>
<td style="text-align:left;">
381 (112.2)
</td>
<td style="text-align:left;">
309.3 (116.4)
</td>
<td style="text-align:left;">
0.697
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
TLAC 2PM-4PM
</td>
<td style="text-align:left;">
390.6 (119.3)
</td>
<td style="text-align:left;">
398.1 (116.7)
</td>
<td style="text-align:left;">
323 (121.5)
</td>
<td style="text-align:left;">
0.693
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
TLAC 6PM-8PM
</td>
<td style="text-align:left;">
313.5 (119.3)
</td>
<td style="text-align:left;">
320.5 (118.4)
</td>
<td style="text-align:left;">
250.7 (108.7)
</td>
<td style="text-align:left;">
0.692
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
TLAC 10AM-12PM
</td>
<td style="text-align:left;">
403.4 (129.8)
</td>
<td style="text-align:left;">
410.9 (127.4)
</td>
<td style="text-align:left;">
335.3 (132.3)
</td>
<td style="text-align:left;">
0.682
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
Mobility problem
</td>
<td style="text-align:left;">
940 (31.6%)
</td>
<td style="text-align:left;">
768 (28.6%)
</td>
<td style="text-align:left;">
172 (57.9%)
</td>
<td style="text-align:left;">
0.672
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
SD on PC 6 (surrogate)
</td>
<td style="text-align:left;">
0.69 (0.27)
</td>
<td style="text-align:left;">
0.7 (0.27)
</td>
<td style="text-align:left;">
0.57 (0.25)
</td>
<td style="text-align:left;">
0.661
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
SATP
</td>
<td style="text-align:left;">
0.08 (0.02)
</td>
<td style="text-align:left;">
0.08 (0.02)
</td>
<td style="text-align:left;">
0.07 (0.02)
</td>
<td style="text-align:left;">
0.658
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
TLAC 8AM-10AM
</td>
<td style="text-align:left;">
338.5 (154)
</td>
<td style="text-align:left;">
344.7 (153.3)
</td>
<td style="text-align:left;">
282.4 (149.3)
</td>
<td style="text-align:left;">
0.629
</td>
</tr>
<tr>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
Education
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0.612
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Less than high school
</td>
<td style="text-align:left;">
945 (31.7%)
</td>
<td style="text-align:left;">
822 (30.7%)
</td>
<td style="text-align:left;">
123 (41.4%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
High school
</td>
<td style="text-align:left;">
739 (24.8%)
</td>
<td style="text-align:left;">
659 (24.6%)
</td>
<td style="text-align:left;">
80 (26.9%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
More than high school
</td>
<td style="text-align:left;">
1294 (43.5%)
</td>
<td style="text-align:left;">
1200 (44.8%)
</td>
<td style="text-align:left;">
94 (31.6%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
TLAC 8PM-10PM
</td>
<td style="text-align:left;">
204.4 (121.5)
</td>
<td style="text-align:left;">
208.8 (122.6)
</td>
<td style="text-align:left;">
165.4 (104.1)
</td>
<td style="text-align:left;">
0.603
</td>
</tr>
<tr>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
Drinking Status
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0.602
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Moderate Drinker
</td>
<td style="text-align:left;">
1445 (48.5%)
</td>
<td style="text-align:left;">
1346 (50.2%)
</td>
<td style="text-align:left;">
99 (33.3%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Non-Drinker
</td>
<td style="text-align:left;">
1266 (42.5%)
</td>
<td style="text-align:left;">
1106 (41.3%)
</td>
<td style="text-align:left;">
160 (53.9%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Heavy Drinker
</td>
<td style="text-align:left;">
181 (6.1%)
</td>
<td style="text-align:left;">
153 (5.7%)
</td>
<td style="text-align:left;">
28 (9.4%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Missing alcohol
</td>
<td style="text-align:left;">
86 (2.9%)
</td>
<td style="text-align:left;">
76 (2.8%)
</td>
<td style="text-align:left;">
10 (3.4%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
TLAC 6AM-8AM
</td>
<td style="text-align:left;">
166.7 (151.2)
</td>
<td style="text-align:left;">
171.1 (153.5)
</td>
<td style="text-align:left;">
127 (121.9)
</td>
<td style="text-align:left;">
0.59
</td>
</tr>
<tr>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
Smoking Status
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0.586
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Never
</td>
<td style="text-align:left;">
1326 (44.5%)
</td>
<td style="text-align:left;">
1233 (46%)
</td>
<td style="text-align:left;">
93 (31.3%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Former
</td>
<td style="text-align:left;">
1147 (38.5%)
</td>
<td style="text-align:left;">
1010 (37.7%)
</td>
<td style="text-align:left;">
137 (46.1%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Current
</td>
<td style="text-align:left;">
505 (17%)
</td>
<td style="text-align:left;">
438 (16.3%)
</td>
<td style="text-align:left;">
67 (22.6%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
CHF
</td>
<td style="text-align:left;">
168 (5.6%)
</td>
<td style="text-align:left;">
119 (4.4%)
</td>
<td style="text-align:left;">
49 (16.5%)
</td>
<td style="text-align:left;">
0.57
</td>
</tr>
<tr>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
Gender
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0.559
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
1523 (51.1%)
</td>
<td style="text-align:left;">
1331 (49.6%)
</td>
<td style="text-align:left;">
192 (64.6%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
1455 (48.9%)
</td>
<td style="text-align:left;">
1350 (50.4%)
</td>
<td style="text-align:left;">
105 (35.4%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
Diabetes
</td>
<td style="text-align:left;">
518 (17.4%)
</td>
<td style="text-align:left;">
444 (16.6%)
</td>
<td style="text-align:left;">
74 (24.9%)
</td>
<td style="text-align:left;">
0.558
</td>
</tr>
<tr>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:left;">
455 (15.3%)
</td>
<td style="text-align:left;">
382 (14.2%)
</td>
<td style="text-align:left;">
73 (24.6%)
</td>
<td style="text-align:left;">
0.558
</td>
</tr>
<tr>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0.553
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Normal
</td>
<td style="text-align:left;">
760 (25.5%)
</td>
<td style="text-align:left;">
663 (24.7%)
</td>
<td style="text-align:left;">
97 (32.7%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Underweight
</td>
<td style="text-align:left;">
29 (1%)
</td>
<td style="text-align:left;">
22 (0.8%)
</td>
<td style="text-align:left;">
7 (2.4%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Overweight
</td>
<td style="text-align:left;">
1150 (38.6%)
</td>
<td style="text-align:left;">
1048 (39.1%)
</td>
<td style="text-align:left;">
102 (34.3%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Obese
</td>
<td style="text-align:left;">
1039 (34.9%)
</td>
<td style="text-align:left;">
948 (35.4%)
</td>
<td style="text-align:left;">
91 (30.6%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
26
</td>
<td style="text-align:left;">
CHD
</td>
<td style="text-align:left;">
244 (8.2%)
</td>
<td style="text-align:left;">
196 (7.3%)
</td>
<td style="text-align:left;">
48 (16.2%)
</td>
<td style="text-align:left;">
0.552
</td>
</tr>
<tr>
<td style="text-align:left;">
27
</td>
<td style="text-align:left;">
Stroke
</td>
<td style="text-align:left;">
174 (5.8%)
</td>
<td style="text-align:left;">
132 (4.9%)
</td>
<td style="text-align:left;">
42 (14.1%)
</td>
<td style="text-align:left;">
0.546
</td>
</tr>
<tr>
<td style="text-align:left;">
28
</td>
<td style="text-align:left;">
Race
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0.525
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
White
</td>
<td style="text-align:left;">
1756 (59%)
</td>
<td style="text-align:left;">
1556 (58%)
</td>
<td style="text-align:left;">
200 (67.3%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Mexican American
</td>
<td style="text-align:left;">
538 (18.1%)
</td>
<td style="text-align:left;">
504 (18.8%)
</td>
<td style="text-align:left;">
34 (11.4%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Other Hispanic
</td>
<td style="text-align:left;">
56 (1.9%)
</td>
<td style="text-align:left;">
53 (2%)
</td>
<td style="text-align:left;">
3 (1%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Black
</td>
<td style="text-align:left;">
534 (17.9%)
</td>
<td style="text-align:left;">
481 (17.9%)
</td>
<td style="text-align:left;">
53 (17.8%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left: 2em;" indentlevel="1">
</td>
<td style="text-align:left;">
Other
</td>
<td style="text-align:left;">
94 (3.2%)
</td>
<td style="text-align:left;">
87 (3.2%)
</td>
<td style="text-align:left;">
7 (2.4%)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
29
</td>
<td style="text-align:left;">
TLAC 12AM-2AM
</td>
<td style="text-align:left;">
25 (60.1)
</td>
<td style="text-align:left;">
25.1 (61.4)
</td>
<td style="text-align:left;">
24.6 (47.7)
</td>
<td style="text-align:left;">
0.511
</td>
</tr>
<tr>
<td style="text-align:left;">
30
</td>
<td style="text-align:left;">
TLAC 10PM-12AM
</td>
<td style="text-align:left;">
85.2 (98.7)
</td>
<td style="text-align:left;">
86.3 (100.5)
</td>
<td style="text-align:left;">
75.3 (80.6)
</td>
<td style="text-align:left;">
0.506
</td>
</tr>
<tr>
<td style="text-align:left;">
31
</td>
<td style="text-align:left;">
TLAC 4AM-6AM
</td>
<td style="text-align:left;">
39.1 (83.2)
</td>
<td style="text-align:left;">
39.6 (85.1)
</td>
<td style="text-align:left;">
34.1 (64.1)
</td>
<td style="text-align:left;">
0.504
</td>
</tr>
<tr>
<td style="text-align:left;">
32
</td>
<td style="text-align:left;">
TLAC 2AM-4AM
</td>
<td style="text-align:left;">
15.7 (52)
</td>
<td style="text-align:left;">
15.4 (52.7)
</td>
<td style="text-align:left;">
18.3 (44.9)
</td>
<td style="text-align:left;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
33
</td>
<td style="text-align:left;">
Wear time
</td>
<td style="text-align:left;">
878.5 (138.5)
</td>
<td style="text-align:left;">
877.1 (134.4)
</td>
<td style="text-align:left;">
891.7 (170.8)
</td>
<td style="text-align:left;">
0.454
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> Data are presented as means (standard deviation) or n (%).
</td>
</tr>
</tfoot>
</table>
<p>Figure 3 displays the AIC, EPIC, and AUC at each stage of the forward selection procedure when using cross-validated AUC as the selection criteria. The scale for AIC and EPIC is shown on the right y axis, while the scale for AUC is shown on the left y axis. Accelerometry predictors are denoted in red font on the horizontal axis. In addition, the stopping point for the procedure is denoted by the large red dot. The blue and green dots correspond to the model which had the lowest (best) EPIC and AIC values, respectively.</p>
<p><img src="vignette_prediction_files/figure-html/unnamed-chunk-10-1.png" width="768" style="display: block; margin: auto;"></p>
<table class="table">
<caption>
AUC for the 5-year mortality model
</caption>
<thead><tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Cross.Validated.AUC
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
TAC
</td>
<td style="text-align:right;">
0.771
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
0.791
</td>
</tr>
<tr>
<td style="text-align:left;">
Smoking Status
</td>
<td style="text-align:right;">
0.800
</td>
</tr>
<tr>
<td style="text-align:left;">
CHF
</td>
<td style="text-align:right;">
0.811
</td>
</tr>
<tr>
<td style="text-align:left;">
Drinking Status
</td>
<td style="text-align:right;">
0.817
</td>
</tr>
<tr>
<td style="text-align:left;">
ASTP
</td>
<td style="text-align:right;">
0.823
</td>
</tr>
<tr>
<td style="text-align:left;">
Mobility problem
</td>
<td style="text-align:right;">
0.828
</td>
</tr>
<tr>
<td style="text-align:left;">
Gender
</td>
<td style="text-align:right;">
0.830
</td>
</tr>
<tr>
<td style="text-align:left;">
SD on PC 6 (surrogate)
</td>
<td style="text-align:right;">
0.833
</td>
</tr>
<tr>
<td style="text-align:left;">
Diabetes
</td>
<td style="text-align:right;">
0.836
</td>
</tr>
<tr>
<td style="text-align:left;">
Education
</td>
<td style="text-align:right;">
0.837
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC 12AM-2AM
</td>
<td style="text-align:right;">
0.838
</td>
</tr>
<tr>
<td style="text-align:left;">
Stroke
</td>
<td style="text-align:right;">
0.838
</td>
</tr>
</tbody>
</table>
<p>Table 6 presents estimated final model coefficients with corresponding standard errors and significance values, according to the complex survey design of NHANES via the svyglm() function. The number of variables used in the model is selected according to across validated AUC criteria. The “adjusted” weights we use for regression analyses are “wtmec4yr_adj_norm”. These weights are calculated using the reweight_accel() function (see ?reweight_accel for help) which re-weights observed participants using age, gender, and ethnicity strata.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Final model fits using the adjusted survey weights.
fit_final &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/survey/man/svyglm.html">svyglm</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"yr5_mort ~"</span>, final_formula )),
                        <span class="dt">design=</span>data_analysis_svy_adj,
                        <span class="dt">family=</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">quasibinomial</a></span>())</code></pre></div>
<table class="table table table-striped">
<caption>
Table 6: Estimated final model coefficients with corresponding standard errors and significance values
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Estimate
</th>
<th style="text-align:right;">
Pr(&gt;|t|)
</th>
<th style="text-align:right;">
OR Estimate
</th>
<th style="text-align:right;">
OR Lower CL
</th>
<th style="text-align:right;">
OR Upper CL
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
-9.511
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.001
</td>
</tr>
<tr>
<td style="text-align:left;">
TAC
</td>
<td style="text-align:right;">
0.007
</td>
<td style="text-align:right;">
0.982
</td>
<td style="text-align:right;">
1.007
</td>
<td style="text-align:right;">
0.508
</td>
<td style="text-align:right;">
1.832
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
0.083
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
1.087
</td>
<td style="text-align:right;">
1.063
</td>
<td style="text-align:right;">
1.112
</td>
</tr>
<tr>
<td style="text-align:left;">
Former Smoker
</td>
<td style="text-align:right;">
0.332
</td>
<td style="text-align:right;">
0.176
</td>
<td style="text-align:right;">
1.394
</td>
<td style="text-align:right;">
0.835
</td>
<td style="text-align:right;">
2.345
</td>
</tr>
<tr>
<td style="text-align:left;">
Current Smoker
</td>
<td style="text-align:right;">
0.797
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
2.219
</td>
<td style="text-align:right;">
1.412
</td>
<td style="text-align:right;">
3.478
</td>
</tr>
<tr>
<td style="text-align:left;">
CHF: yes
</td>
<td style="text-align:right;">
0.777
</td>
<td style="text-align:right;">
0.013
</td>
<td style="text-align:right;">
2.175
</td>
<td style="text-align:right;">
1.177
</td>
<td style="text-align:right;">
3.930
</td>
</tr>
<tr>
<td style="text-align:left;">
Non-Drinker
</td>
<td style="text-align:right;">
0.565
</td>
<td style="text-align:right;">
0.010
</td>
<td style="text-align:right;">
1.759
</td>
<td style="text-align:right;">
1.165
</td>
<td style="text-align:right;">
2.677
</td>
</tr>
<tr>
<td style="text-align:left;">
Heavy Drinker
</td>
<td style="text-align:right;">
0.963
</td>
<td style="text-align:right;">
0.018
</td>
<td style="text-align:right;">
2.620
</td>
<td style="text-align:right;">
1.148
</td>
<td style="text-align:right;">
5.673
</td>
</tr>
<tr>
<td style="text-align:left;">
Missing Alcohol
</td>
<td style="text-align:right;">
0.747
</td>
<td style="text-align:right;">
0.106
</td>
<td style="text-align:right;">
2.111
</td>
<td style="text-align:right;">
0.752
</td>
<td style="text-align:right;">
5.193
</td>
</tr>
<tr>
<td style="text-align:left;">
ASTP
</td>
<td style="text-align:right;">
0.382
</td>
<td style="text-align:right;">
0.016
</td>
<td style="text-align:right;">
1.465
</td>
<td style="text-align:right;">
1.078
</td>
<td style="text-align:right;">
1.993
</td>
</tr>
<tr>
<td style="text-align:left;">
Mobility Problem
</td>
<td style="text-align:right;">
0.546
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
1.726
</td>
<td style="text-align:right;">
1.057
</td>
<td style="text-align:right;">
2.816
</td>
</tr>
<tr>
<td style="text-align:left;">
Gender: female
</td>
<td style="text-align:right;">
-0.648
</td>
<td style="text-align:right;">
0.007
</td>
<td style="text-align:right;">
0.523
</td>
<td style="text-align:right;">
0.332
</td>
<td style="text-align:right;">
0.817
</td>
</tr>
<tr>
<td style="text-align:left;">
SD on PC 6 (surrogate)
</td>
<td style="text-align:right;">
-0.291
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.748
</td>
<td style="text-align:right;">
0.629
</td>
<td style="text-align:right;">
0.885
</td>
</tr>
<tr>
<td style="text-align:left;">
Diabetes: yes
</td>
<td style="text-align:right;">
0.216
</td>
<td style="text-align:right;">
0.310
</td>
<td style="text-align:right;">
1.241
</td>
<td style="text-align:right;">
0.780
</td>
<td style="text-align:right;">
1.937
</td>
</tr>
<tr>
<td style="text-align:left;">
High school Education
</td>
<td style="text-align:right;">
-0.008
</td>
<td style="text-align:right;">
0.973
</td>
<td style="text-align:right;">
0.992
</td>
<td style="text-align:right;">
0.582
</td>
<td style="text-align:right;">
1.694
</td>
</tr>
<tr>
<td style="text-align:left;">
More than high school Education
</td>
<td style="text-align:right;">
-0.231
</td>
<td style="text-align:right;">
0.309
</td>
<td style="text-align:right;">
0.794
</td>
<td style="text-align:right;">
0.489
</td>
<td style="text-align:right;">
1.294
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC 12AM-2AM
</td>
<td style="text-align:right;">
0.128
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:right;">
1.137
</td>
<td style="text-align:right;">
0.958
</td>
<td style="text-align:right;">
1.322
</td>
</tr>
<tr>
<td style="text-align:left;">
StrokeYes
</td>
<td style="text-align:right;">
0.193
</td>
<td style="text-align:right;">
0.505
</td>
<td style="text-align:right;">
1.213
</td>
<td style="text-align:right;">
0.636
</td>
<td style="text-align:right;">
2.227
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="comparison-to-the-models-without-pa-accelerometry-derived-measures" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-to-the-models-without-pa-accelerometry-derived-measures" class="anchor"></a>Comparison to the models without PA accelerometry-derived measures</h1>
<p>Non-PA model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Age, Smoking status, Coronary Heart Failure (CHF), Drinking status, Active-to-sedentary transition probability, Mobility Problem, Gender, Diabetes, Education, and Stroke</span>
noPAvars &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Age"</span>, <span class="st">"SmokeCigs"</span>, <span class="st">"CHF"</span>, <span class="st">"DrinkStatus"</span>, <span class="st">"MobilityProblem"</span>,
              <span class="st">"Gender"</span>, <span class="st">"Diabetes"</span>, <span class="st">"EducationAdult"</span>, <span class="st">"Stroke"</span>)
noPA_formula &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(noPAvars,<span class="dt">collapse=</span><span class="st">"+"</span>)
fit_svy_noPA &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/survey/man/svyglm.html">svyglm</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"yr5_mort ~"</span>, noPA_formula  )),<span class="dt">design=</span>data_analysis_svy_adj, <span class="dt">family=</span><span class="kw"><a href="https://rdrr.io/r/stats/family.html">quasibinomial</a></span>())</code></pre></div>
<p>AUC for the non-PA model: calculate 10-fold CV AUC for the no-PA model</p>
<p>Cross validated AUC in the non-PA model is 0.799</p>
</div>
<div id="comparison-with-the-best-forward-selction-no-pa-model" class="section level1">
<h1 class="hasAnchor">
<a href="#comparison-with-the-best-forward-selction-no-pa-model" class="anchor"></a>Comparison with the best forward selction no-PA model</h1>
<p>Model selection results (cross-validated AUC criteria)</p>
<p><img src="vignette_prediction_files/figure-html/unnamed-chunk-18-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Cross-validated AUC of the forward selection model without physical activity: the optimal 10 variable model is 0.803.</p>
<table class="table">
<caption>
AUC for the model without physical activity predictors
</caption>
<thead><tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:right;">
Cross.Validated.AUC
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
0.740
</td>
</tr>
<tr>
<td style="text-align:left;">
MobilityProblem
</td>
<td style="text-align:right;">
0.767
</td>
</tr>
<tr>
<td style="text-align:left;">
SmokeCigs
</td>
<td style="text-align:right;">
0.781
</td>
</tr>
<tr>
<td style="text-align:left;">
Gender
</td>
<td style="text-align:right;">
0.788
</td>
</tr>
<tr>
<td style="text-align:left;">
DrinkStatus
</td>
<td style="text-align:right;">
0.795
</td>
</tr>
<tr>
<td style="text-align:left;">
CHF
</td>
<td style="text-align:right;">
0.799
</td>
</tr>
<tr>
<td style="text-align:left;">
Diabetes
</td>
<td style="text-align:right;">
0.801
</td>
</tr>
<tr>
<td style="text-align:left;">
BMI_cat
</td>
<td style="text-align:right;">
0.802
</td>
</tr>
<tr>
<td style="text-align:left;">
Stroke
</td>
<td style="text-align:right;">
0.803
</td>
</tr>
<tr>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:right;">
0.803
</td>
</tr>
</tbody>
</table>
</div>
<div id="subgroups-of-the-population" class="section level1">
<h1 class="hasAnchor">
<a href="#subgroups-of-the-population" class="anchor"></a>Subgroups of the population</h1>
<pre><code>## 
##    0    1 
## 1828   98</code></pre>
<pre><code>## 
##   0   1 
## 853 199</code></pre>
<table class="table">
<thead><tr>
<th style="text-align:left;">
all
</th>
<th style="text-align:right;">
all
</th>
<th style="text-align:left;">
Age 50-70
</th>
<th style="text-align:right;">
Age 50-70
</th>
<th style="text-align:left;">
Age 70 above
</th>
<th style="text-align:right;">
Age 70 above
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
TAC
</td>
<td style="text-align:right;">
0.771
</td>
<td style="text-align:left;">
TAC
</td>
<td style="text-align:right;">
0.701
</td>
<td style="text-align:left;">
ASTP
</td>
<td style="text-align:right;">
0.711
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
0.758
</td>
<td style="text-align:left;">
MVPA
</td>
<td style="text-align:right;">
0.700
</td>
<td style="text-align:left;">
TAC
</td>
<td style="text-align:right;">
0.706
</td>
</tr>
<tr>
<td style="text-align:left;">
MVPA
</td>
<td style="text-align:right;">
0.745
</td>
<td style="text-align:left;">
MobilityProblem
</td>
<td style="text-align:right;">
0.677
</td>
<td style="text-align:left;">
TLAC_6
</td>
<td style="text-align:right;">
0.685
</td>
</tr>
<tr>
<td style="text-align:left;">
ASTP
</td>
<td style="text-align:right;">
0.733
</td>
<td style="text-align:left;">
TLAC
</td>
<td style="text-align:right;">
0.672
</td>
<td style="text-align:left;">
ST
</td>
<td style="text-align:right;">
0.679
</td>
</tr>
<tr>
<td style="text-align:left;">
ST
</td>
<td style="text-align:right;">
0.728
</td>
<td style="text-align:left;">
ST
</td>
<td style="text-align:right;">
0.661
</td>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
0.676
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC
</td>
<td style="text-align:right;">
0.721
</td>
<td style="text-align:left;">
EducationAdult
</td>
<td style="text-align:right;">
0.658
</td>
<td style="text-align:left;">
TLAC_7
</td>
<td style="text-align:right;">
0.655
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC_7
</td>
<td style="text-align:right;">
0.697
</td>
<td style="text-align:left;">
TLAC_8
</td>
<td style="text-align:right;">
0.655
</td>
<td style="text-align:left;">
TLAC
</td>
<td style="text-align:right;">
0.654
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC_9
</td>
<td style="text-align:right;">
0.697
</td>
<td style="text-align:left;">
TLAC_10
</td>
<td style="text-align:right;">
0.654
</td>
<td style="text-align:left;">
MVPA
</td>
<td style="text-align:right;">
0.654
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC_8
</td>
<td style="text-align:right;">
0.693
</td>
<td style="text-align:left;">
TLAC_9
</td>
<td style="text-align:right;">
0.650
</td>
<td style="text-align:left;">
sPC6
</td>
<td style="text-align:right;">
0.649
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC_10
</td>
<td style="text-align:right;">
0.692
</td>
<td style="text-align:left;">
TLAC_7
</td>
<td style="text-align:right;">
0.648
</td>
<td style="text-align:left;">
TLAC_8
</td>
<td style="text-align:right;">
0.636
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC_6
</td>
<td style="text-align:right;">
0.682
</td>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
0.647
</td>
<td style="text-align:left;">
TLAC_10
</td>
<td style="text-align:right;">
0.634
</td>
</tr>
<tr>
<td style="text-align:left;">
MobilityProblem
</td>
<td style="text-align:right;">
0.672
</td>
<td style="text-align:left;">
ASTP
</td>
<td style="text-align:right;">
0.642
</td>
<td style="text-align:left;">
TLAC_9
</td>
<td style="text-align:right;">
0.633
</td>
</tr>
<tr>
<td style="text-align:left;">
sPC6
</td>
<td style="text-align:right;">
0.661
</td>
<td style="text-align:left;">
SATP
</td>
<td style="text-align:right;">
0.636
</td>
<td style="text-align:left;">
TLAC_5
</td>
<td style="text-align:right;">
0.626
</td>
</tr>
<tr>
<td style="text-align:left;">
SATP
</td>
<td style="text-align:right;">
0.658
</td>
<td style="text-align:left;">
DrinkStatus
</td>
<td style="text-align:right;">
0.625
</td>
<td style="text-align:left;">
MobilityProblem
</td>
<td style="text-align:right;">
0.616
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC_5
</td>
<td style="text-align:right;">
0.629
</td>
<td style="text-align:left;">
SmokeCigs
</td>
<td style="text-align:right;">
0.624
</td>
<td style="text-align:left;">
SmokeCigs
</td>
<td style="text-align:right;">
0.589
</td>
</tr>
<tr>
<td style="text-align:left;">
EducationAdult
</td>
<td style="text-align:right;">
0.612
</td>
<td style="text-align:left;">
TLAC_6
</td>
<td style="text-align:right;">
0.621
</td>
<td style="text-align:left;">
SATP
</td>
<td style="text-align:right;">
0.588
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC_11
</td>
<td style="text-align:right;">
0.603
</td>
<td style="text-align:left;">
sPC6
</td>
<td style="text-align:right;">
0.620
</td>
<td style="text-align:left;">
TLAC_2
</td>
<td style="text-align:right;">
0.581
</td>
</tr>
<tr>
<td style="text-align:left;">
DrinkStatus
</td>
<td style="text-align:right;">
0.602
</td>
<td style="text-align:left;">
TLAC_4
</td>
<td style="text-align:right;">
0.614
</td>
<td style="text-align:left;">
Gender
</td>
<td style="text-align:right;">
0.581
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC_4
</td>
<td style="text-align:right;">
0.590
</td>
<td style="text-align:left;">
Diabetes
</td>
<td style="text-align:right;">
0.605
</td>
<td style="text-align:left;">
TLAC_3
</td>
<td style="text-align:right;">
0.569
</td>
</tr>
<tr>
<td style="text-align:left;">
SmokeCigs
</td>
<td style="text-align:right;">
0.586
</td>
<td style="text-align:left;">
TLAC_11
</td>
<td style="text-align:right;">
0.593
</td>
<td style="text-align:left;">
TLAC_11
</td>
<td style="text-align:right;">
0.561
</td>
</tr>
<tr>
<td style="text-align:left;">
CHF
</td>
<td style="text-align:right;">
0.570
</td>
<td style="text-align:left;">
CHF
</td>
<td style="text-align:right;">
0.580
</td>
<td style="text-align:left;">
CHF
</td>
<td style="text-align:right;">
0.553
</td>
</tr>
<tr>
<td style="text-align:left;">
Gender
</td>
<td style="text-align:right;">
0.559
</td>
<td style="text-align:left;">
TLAC_5
</td>
<td style="text-align:right;">
0.577
</td>
<td style="text-align:left;">
TLAC_1
</td>
<td style="text-align:right;">
0.548
</td>
</tr>
<tr>
<td style="text-align:left;">
Diabetes
</td>
<td style="text-align:right;">
0.558
</td>
<td style="text-align:left;">
WT
</td>
<td style="text-align:right;">
0.566
</td>
<td style="text-align:left;">
DrinkStatus
</td>
<td style="text-align:right;">
0.546
</td>
</tr>
<tr>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:right;">
0.558
</td>
<td style="text-align:left;">
TLAC_1
</td>
<td style="text-align:right;">
0.558
</td>
<td style="text-align:left;">
BMI_cat
</td>
<td style="text-align:right;">
0.543
</td>
</tr>
<tr>
<td style="text-align:left;">
BMI_cat
</td>
<td style="text-align:right;">
0.553
</td>
<td style="text-align:left;">
Gender
</td>
<td style="text-align:right;">
0.553
</td>
<td style="text-align:left;">
Stroke
</td>
<td style="text-align:right;">
0.542
</td>
</tr>
<tr>
<td style="text-align:left;">
CHD
</td>
<td style="text-align:right;">
0.552
</td>
<td style="text-align:left;">
CHD
</td>
<td style="text-align:right;">
0.551
</td>
<td style="text-align:left;">
WT
</td>
<td style="text-align:right;">
0.540
</td>
</tr>
<tr>
<td style="text-align:left;">
Stroke
</td>
<td style="text-align:right;">
0.546
</td>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:right;">
0.549
</td>
<td style="text-align:left;">
CHD
</td>
<td style="text-align:right;">
0.533
</td>
</tr>
<tr>
<td style="text-align:left;">
Race
</td>
<td style="text-align:right;">
0.525
</td>
<td style="text-align:left;">
Stroke
</td>
<td style="text-align:right;">
0.544
</td>
<td style="text-align:left;">
TLAC_4
</td>
<td style="text-align:right;">
0.525
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC_1
</td>
<td style="text-align:right;">
0.511
</td>
<td style="text-align:left;">
BMI_cat
</td>
<td style="text-align:right;">
0.540
</td>
<td style="text-align:left;">
Diabetes
</td>
<td style="text-align:right;">
0.516
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC_12
</td>
<td style="text-align:right;">
0.506
</td>
<td style="text-align:left;">
TLAC_3
</td>
<td style="text-align:right;">
0.532
</td>
<td style="text-align:left;">
Cancer
</td>
<td style="text-align:right;">
0.516
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC_3
</td>
<td style="text-align:right;">
0.504
</td>
<td style="text-align:left;">
Race
</td>
<td style="text-align:right;">
0.519
</td>
<td style="text-align:left;">
TLAC_12
</td>
<td style="text-align:right;">
0.501
</td>
</tr>
<tr>
<td style="text-align:left;">
TLAC_2
</td>
<td style="text-align:right;">
0.500
</td>
<td style="text-align:left;">
TLAC_2
</td>
<td style="text-align:right;">
0.465
</td>
<td style="text-align:left;">
EducationAdult
</td>
<td style="text-align:right;">
0.496
</td>
</tr>
<tr>
<td style="text-align:left;">
WT
</td>
<td style="text-align:right;">
0.454
</td>
<td style="text-align:left;">
TLAC_12
</td>
<td style="text-align:right;">
0.401
</td>
<td style="text-align:left;">
Race
</td>
<td style="text-align:right;">
0.493
</td>
</tr>
</tbody>
</table>
<pre><code>## [1] "TAC+EducationAdult+CHF+TLAC_10+Cancer+CHD+Diabetes+DrinkStatus+TLAC_8+TLAC_4+SmokeCigs+MVPA+MobilityProblem+TLAC_2+WT+BMI_cat+Stroke"</code></pre>
<pre><code>## [1] "ASTP+Age+sPC6+SmokeCigs+Gender+CHF+TLAC_2"</code></pre>
</div>
<div id="robustness-of-the-final-model-results" class="section level1">
<h1 class="hasAnchor">
<a href="#robustness-of-the-final-model-results" class="anchor"></a>Robustness of the final model results</h1>
<p>Our analysis includes 20 variables derived directly from accelerometry measurements. These variables may be highly correlated with one another and with age. The correlation plot between age and all activity derived variables is presented below. Age has high negative correlations with TAC, TLAC and positive correlation with sedentary time. TAC is highly correlated with most activity derived measures, including MVPA, SATP, Sedentary time, TLAC, and TLAC 4PM – 6PM, 6PM – 8PM, 2PM – 4PM, 12PM – 2PM, 10PM – 12 PM, 8AM – 10AM, 6AM – 8AM. ASTP, sedentary time, TLAC and SATP are among top activity derived measures that are highly correlated with multiple other variables. The surrogate for the standard deviation on the 6th PC has low correlation with other activity derived variables, which explains its contribution to the increase in AUC in the forward selection model beyond the conventional activity measures.</p>
<p>Due to high correlation among different activity summaries, many of these variables contain similar information and often replace each other in the final mortality prediction model. Thus, in practice, we suggest examining a smaller subset of activity derived variables including: TLAC, sedentary and wear time, MVPA, SATP, ASTP, and the surrogates the standard deviation of the sixth PC (SD on PC 6).</p>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<p>The 5-year mortality prediction model reported in this analysis used cross validated AUC as the forward selection criteria. We examined robustness of our results to using EPIC (Figure 4) and AIC (Figure 5) criteria to enter a new variable into the model. While there is difference in the order in which the variables enter into the model, all 3 criteria approaches select mostly the same top 8 variables for the final model. The notable exception is that neither AIC nor EPIC select TAC into the model. This is likely due to the fact that age and TAC have similar explanatory power and both EPIC/AIC select age first. Then, once age is included in the model, other accelerometry measures explain more of the variability unexplained by age than TAC.</p>
<p><img src="vignette_prediction_files/figure-html/unnamed-chunk-28-1.png" width="768" style="display: block; margin: auto;"></p>
<p><img src="vignette_prediction_files/figure-html/unnamed-chunk-30-1.png" width="768" style="display: block; margin: auto;"></p>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ol style="list-style-type: decimal">
<li><p>Thomas Lumley, Alastair Scott; AIC and BIC for modeling with complex survey data, <em>Journal of Survey Statistics and Methodology</em>, Volume 3, Issue 1, 1 March 2015, Pages 1-18, <a href="https://doi.org/10.1093/jssam/smu021" class="uri">https://doi.org/10.1093/jssam/smu021</a></p></li>
<li><p>Leroux A. : rnhanesdata: NHANES Accelerometry Data Pipeline. URL:<a href="https://github.com/andrew-leroux/rnhanesdata" class="uri">https://github.com/andrew-leroux/rnhanesdata</a>. R package version 1.0.</p></li>
</ol>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#prerequisites">Prerequisites</a><ul class="nav nav-pills nav-stacked">
<li><a href="#nhanes-2003-2004-and-2005-2006-5-year-mortality-model-data-selection">NHANES 2003-2004 and 2005-2006 5-year mortality model data selection</a></li>
      <li><a href="#intuition-behind-fpca">Intuition behind fPCA</a></li>
      <li><a href="#mortality-prediction-model">Mortality prediction model</a></li>
      <li><a href="#results">Results</a></li>
      </ul>
</li>
      <li><a href="#comparison-to-the-models-without-pa-accelerometry-derived-measures">Comparison to the models without PA accelerometry-derived measures</a></li>
      <li><a href="#comparison-with-the-best-forward-selction-no-pa-model">Comparison with the best forward selction no-PA model</a></li>
      <li><a href="#subgroups-of-the-population">Subgroups of the population</a></li>
      <li>
<a href="#robustness-of-the-final-model-results">Robustness of the final model results</a><ul class="nav nav-pills nav-stacked">
<li><a href="#references">References</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Andrew Leroux.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
